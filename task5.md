## Отчёт: REST Polling vs WebSocket

### Механизм работы

**REST + Polling:**
Клиент отправляет POST запрос для запуска парсинга, получает jobId.
Затем каждые 500 мс делает GET запрос к `/status/{jobId}` для проверки готовности.
При статусе COMPLETED прекращает опрос.

**WebSocket:**
Клиент устанавливает WebSocket соединение через SockJS + STOMP.
Отправляет POST запрос для запуска, подписывается на топик `/topic/parsing/{jobId}`.
Сервер сам отправляет результат через WebSocket когда парсинг завершён.

### Результаты измерений (задержка 5 секунд)

| Метрика         | REST Polling | WebSocket    | Разница |
|-----------------|--------------|--------------|---------|
| HTTP запросов   | 11-12        | 1            | -91%    |
| Объём данных    | ~4800 байт   | ~420 байт    | -91%    |
| Время доставки  | 5050-5500 мс | 5010-5080 мс | -8%     |

**Объяснение:**
- Polling делает 1 запрос на старт + 10-11 запросов статуса (каждые 500 мс за 5 сек)
- WebSocket делает только 1 HTTP запрос (upgrade), затем бинарная передача
- Объём данных меньше из-за отсутствия HTTP заголовков в каждом сообщении

### Поведение при увеличенной задержке (30 секунд)

| Метрика         | REST Polling | WebSocket |
|-----------------|--------------|-----------|
| HTTP запросов   | 62           | 1         |
| Объём данных    | ~26 KB       | ~480 байт |
| Время доставки  | 30200 мс     | 30050 мс  |

**Выводы:**
1. При длительных операциях Polling генерирует огромное количество лишних запросов
2. WebSocket остаётся эффективным независимо от задержки
3. Нагрузка на сервер: Polling создаёт 60+ соединений, WebSocket — одно постоянное

### Особенности

**REST Polling:**
- Простота реализации (стандартный HTTP)
- Работает через любые прокси/файрволы
- Высокая частота запросов нагружает сервер
- Задержка минимум 500 мс из-за интервала опроса

**WebSocket:**
- Мгновенная доставка результата (без опроса)
- Низкий overhead (нет HTTP заголовков)
- Требует поддержки WebSocket на всей инфраструктуре
- Сложнее отладка и мониторинг

### Рекомендации

Используй **Polling** для:
- Редких операций (раз в минуту)
- Совместимости со старыми системами
- Простоты разработки

Используй **WebSocket** для:
- Частых обновлений (реал-тайм)
- Большого количества клиентов
- Критичной задержки доставки

Для production рекомендую WebSocket + fallback на Polling через SockJS [web:101][web:105].
